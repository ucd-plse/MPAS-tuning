[machine]
project_root = <REPLACE_WITH_PATH_TO_REPO_ROOT>
src_search_paths = ${project_root}/src

[target]
src_files = ${machine:project_root}/src/core_atmosphere/dynamics/mpas_atm_time_integration.F90
search_patterns = 
    ^::atm_time_integration::.*
ignore_patterns =
    .*::scale_arr_buffer
    .*::scale_array_buffer
    ^.*::atm_timestep::xtime
    ^.*::atm_srk3::u
    ^.*::atm_srk3::scalars_2
    ^.*::atm_srk3::rqvdynten
    ^.*::atm_rk_integration_setup::ru
    ^.*::atm_rk_integration_setup::ru_save
    ^.*::atm_rk_integration_setup::rw
    ^.*::atm_rk_integration_setup::rw_save
    ^.*::atm_rk_integration_setup::rtheta_p
    ^.*::atm_rk_integration_setup::rtheta_p_save
    ^.*::atm_rk_integration_setup::rho_p
    ^.*::atm_rk_integration_setup::rho_p_save
    ^.*::atm_rk_integration_setup::rho_zz_old_split
    ^.*::atm_rk_integration_setup::u_1
    ^.*::atm_rk_integration_setup::u_2
    ^.*::atm_rk_integration_setup::w_1
    ^.*::atm_rk_integration_setup::w_2
    ^.*::atm_rk_integration_setup::theta_m_1
    ^.*::atm_rk_integration_setup::theta_m_2
    ^.*::atm_rk_integration_setup::rho_zz_1
    ^.*::atm_rk_integration_setup::rho_zz_2
    ^.*::atm_rk_integration_setup::scalars_2
    ^.*::atm_compute_moist_coefficients::cqw
    ^.*::atm_compute_moist_coefficients::cqu
    ^.*::atm_compute_vert_imp_coefs::cqw
    ^.*::atm_compute_vert_imp_coefs::alpha_tri
    ^.*::atm_compute_vert_imp_coefs::gamma_tri
    ^.*::atm_compute_vert_imp_coefs::a_tri
    ^.*::atm_compute_vert_imp_coefs::cofwr
    ^.*::atm_compute_vert_imp_coefs::cofwz
    ^.*::atm_compute_vert_imp_coefs::coftz
    ^.*::atm_compute_vert_imp_coefs::cofwt
    ^.*::atm_compute_vert_imp_coefs::cofrz
    ^.*::atm_recover_large_step_variables::w_tend
    ^.*::atm_recover_large_step_variables::ruAvg
    ^.*::atm_recover_large_step_variables::wwAvg
    ^.*::atm_recover_large_step_variables::rho_pp
    ^.*::atm_recover_large_step_variables::rho_p_save
    ^.*::atm_recover_large_step_variables::rho_p
    ^.*::atm_recover_large_step_variables::ru_p
    ^.*::atm_recover_large_step_variables::ru_save
    ^.*::atm_recover_large_step_variables::ru
    ^.*::atm_recover_large_step_variables::rtheta_pp
    ^.*::atm_recover_large_step_variables::rtheta_p_save
    ^.*::atm_recover_large_step_variables::rtheta_p
    ^.*::atm_recover_large_step_variables::rtheta_pp_old
    ^.*::atm_recover_large_step_variables::rw_p
    ^.*::atm_recover_large_step_variables::rw_save
    ^.*::atm_recover_large_step_variables::rw
    ^.*::performs::rho_zz
    ^.*::performs::theta_m
    ^.*::performs::w
    ^.*::performs::rtheta_pp
    ^.*::performs::rtheta_pp_old
    ^.*::performs::ru_p
    ^.*::performs::rw_p
    ^.*::performs::exner
    ^.*::performs::cqu
    ^.*::performs::ruAvg
    ^.*::performs::wwAvg
    ^.*::performs::rho_pp
    ^.*::performs::cofwt
    ^.*::performs::coftz
    ^.*::performs::cofrz
    ^.*::performs::cofwr
    ^.*::performs::cofwz
    ^.*::performs::a_tri
    ^.*::performs::alpha_tri
    ^.*::performs::gamma_tri
    ^.*::performs::tend_ru
    ^.*::performs::tend_rho
    ^.*::performs::tend_rt
    ^.*::performs::tend_rw
    ^.*::performs::ru
    ^.*::performs::ru_save
    ^.*::performs::rw
    ^.*::performs::rw_save
    ^.*::updates::theta_m
    ^.*::updates::rtheta_pp
    ^.*::updates::rtheta_pp_old
    ^.*::updates::ru_p
    ^.*::atm_set_smlstep_pert_variables::wwAvg
    ^.*::atm_set_smlstep_pert_variables::rw_save
    ^.*::atm_set_smlstep_pert_variables::rw
    ^.*::atm_set_smlstep_pert_variables::rw_p
    ^.*::atm_set_smlstep_pert_variables::w
    ^.*::atm_set_smlstep_pert_variables::rtheta_p
    ^.*::atm_set_smlstep_pert_variables::rtheta_p_save
    ^.*::atm_set_smlstep_pert_variables::rtheta_pp
    ^.*::atm_set_smlstep_pert_variables::rtheta_base
    ^.*::atm_set_smlstep_pert_variables::rt_diabatic_tend
    ^.*::atm_set_smlstep_pert_variables::theta_m
    ^.*::atm_set_smlstep_pert_variables::rho_zz
    ^.*::atm_set_smlstep_pert_variables::rho_p
    ^.*::atm_set_smlstep_pert_variables::rho_p_save
    ^.*::atm_set_smlstep_pert_variables::rho_pp
    ^.*::atm_set_smlstep_pert_variables::ruAvg
    ^.*::atm_set_smlstep_pert_variables::ru_save
    ^.*::atm_set_smlstep_pert_variables::ru_p
    ^.*::atm_set_smlstep_pert_variables::ru
    ^.*::atm_set_smlstep_pert_variables::u
    ^.*::atm_set_smlstep_pert_variables::exner
    ^.*::atm_set_smlstep_pert_variables::exner_base
    ^.*::atm_set_smlstep_pert_variables::pressure_p
    ^.*::atm_advance_scalars::scalar_old
    ^.*::atm_advance_scalars::scalar_new
    ^.*::atm_advance_scalars::kdiff
    ^.*::atm_advance_scalars::wwAvg
    ^.*::atm_advance_scalars::scalar_tend_save
    ^.*::atm_advance_scalars_mono::wwAvg
    ^.*::atm_advance_scalars_mono::scalar_tend
    ^.*::atm_advance_scalars_mono::scalars_old
    ^.*::atm_advance_scalars_mono::scalars_new
    ^.*::atm_compute_dyn_tend::c_s
    ^.*::atm_compute_dyn_tend::rho_zz
    ^.*::atm_compute_dyn_tend::u
    ^.*::atm_compute_dyn_tend::w
    ^.*::atm_compute_dyn_tend::theta_m
    ^.*::atm_compute_dyn_tend::v
    ^.*::atm_compute_dyn_tend::kdiff
    ^.*::atm_compute_dyn_tend::ru
    ^.*::atm_compute_dyn_tend::ru_save
    ^.*::atm_compute_dyn_tend::rw
    ^.*::atm_compute_dyn_tend::rw_save
    ^.*::atm_compute_dyn_tend::divergence
    ^.*::atm_compute_dyn_tend::vorticity
    ^.*::atm_compute_dyn_tend::ke
    ^.*::atm_compute_dyn_tend::pv_edge
    ^.*::atm_compute_dyn_tend::h_divergence
    ^.*::atm_compute_dyn_tend::exner
    ^.*::atm_compute_dyn_tend::tend_rtheta_adv
    ^.*::atm_compute_dyn_tend::rthdynten
    ^.*::atm_compute_dyn_tend::tend_u
    ^.*::atm_compute_dyn_tend::tend_theta
    ^.*::atm_compute_dyn_tend::tend_w
    ^.*::atm_compute_dyn_tend::tend_rho
    ^.*::atm_compute_dyn_tend::rt_diabatic_tend
    ^.*::atm_compute_dyn_tend::tend_u_euler
    ^.*::atm_compute_dyn_tend::tend_theta_euler
    ^.*::atm_compute_dyn_tend::tend_w_euler
    ^.*::atm_compute_dyn_tend::cqw
    ^.*::atm_compute_dyn_tend::cqu
    ^.*::atm_compute_solve_diagnostics::u
    ^.*::atm_compute_solve_diagnostics::v
    ^.*::atm_compute_solve_diagnostics::h_edge
    ^.*::atm_compute_solve_diagnostics::vorticity
    ^.*::atm_compute_solve_diagnostics::divergence
    ^.*::atm_compute_solve_diagnostics::ke
    ^.*::atm_compute_solve_diagnostics::pv_edge
    ^.*::atm_compute_solve_diagnostics::pv_vertex
    ^.*::atm_compute_solve_diagnostics::pv_cell
    ^.*::atm_compute_solve_diagnostics::gradPVn
    ^.*::atm_compute_solve_diagnostics::gradPVt
    ^.*::atm_init_coupled_diagnostics::theta_m
    ^.*::atm_init_coupled_diagnostics::rho_zz
    ^.*::atm_init_coupled_diagnostics::rho_p
    ^.*::atm_init_coupled_diagnostics::rtheta_base
    ^.*::atm_init_coupled_diagnostics::rtheta_p
    ^.*::atm_init_coupled_diagnostics::ru
    ^.*::atm_init_coupled_diagnostics::rw
    ^.*::atm_init_coupled_diagnostics::u
    ^.*::atm_init_coupled_diagnostics::w
    ^.*::atm_init_coupled_diagnostics::pressure_p
    ^.*::atm_init_coupled_diagnostics::pressure_base
    ^.*::atm_init_coupled_diagnostics::exner
    ^.*::atm_init_coupled_diagnostics::exner_base
    ^.*::atm_rk_dynamics_substep_finish::ru
    ^.*::atm_rk_dynamics_substep_finish::ru_save
    ^.*::atm_rk_dynamics_substep_finish::rw
    ^.*::atm_rk_dynamics_substep_finish::rw_save
    ^.*::atm_rk_dynamics_substep_finish::rtheta_p
    ^.*::atm_rk_dynamics_substep_finish::rtheta_p_save
    ^.*::atm_rk_dynamics_substep_finish::rho_p
    ^.*::atm_rk_dynamics_substep_finish::rho_p_save
    ^.*::atm_rk_dynamics_substep_finish::rho_zz_old_split
    ^.*::atm_rk_dynamics_substep_finish::ruAvg
    ^.*::atm_rk_dynamics_substep_finish::ruAvg_split
    ^.*::atm_rk_dynamics_substep_finish::wwAvg
    ^.*::atm_rk_dynamics_substep_finish::wwAvg_split
    ^.*::atm_rk_dynamics_substep_finish::u_1
    ^.*::atm_rk_dynamics_substep_finish::u_2
    ^.*::atm_rk_dynamics_substep_finish::w_1
    ^.*::atm_rk_dynamics_substep_finish::w_2
    ^.*::atm_rk_dynamics_substep_finish::theta_m_1
    ^.*::atm_rk_dynamics_substep_finish::theta_m_2
    ^.*::atm_rk_dynamics_substep_finish::rho_zz_1
    ^.*::atm_rk_dynamics_substep_finish::rho_zz_2
    ^.*::atm_bdy_adjust_dynamics_speczone_tend::tend_ru
    ^.*::atm_bdy_adjust_dynamics_speczone_tend::tend_rho
    ^.*::atm_bdy_adjust_dynamics_speczone_tend::tend_rt
    ^.*::atm_bdy_adjust_dynamics_speczone_tend::tend_rw
    ^.*::atm_bdy_adjust_dynamics_speczone_tend::rt_diabatic_tend
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::tend_ru
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::tend_rho
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::tend_rt
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::tend_rw
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::ru
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::theta_m
    ^.*::atm_bdy_adjust_dynamics_relaxzone_tend::rho_zz
    ^.*::atm_bdy_reset_speczone_values::theta_m
    ^.*::atm_bdy_reset_speczone_values::rtheta_p
    ^.*::atm_bdy_reset_speczone_values::rtheta_base
    ^.*::atm_bdy_adjust_scalars::scalars_new
    ^.*::atm_bdy_set_scalars::scalars_new
    ^.*::summarize_timestep::w
    ^.*::summarize_timestep::u
    ^.*::summarize_timestep::v
additional_plugin_flags =
    -D_MPI
    -DNOMPIMOD
    -DCORE_ATMOSPHERE
    -DMPAS_NAMELIST_SUFFIX=atmosphere
    -DMPAS_NATIVE_TIMERS
    -DDO_PHYSICS

[build]
cmd = ./scripts/build_MPAS_atm_intel_gptl.sh
working_dir = ${machine:project_root}

[run]
cmd = make clean && mpirun -n 64 ../../atmosphere_model && cat log.atmosphere.0000.out
working_dir = ${machine:project_root}/experiments/240km_uniform

[eval]
cmd = python3 eval.py
working_dir = ${machine:project_root}/experiments/240km_uniform
pass_log_path = True

[Derecho]
env_script = ${machine:project_root}/scripts/set_MPAS_env_intel.sh
copy_ignore =
    atmosphere_model
    history.*
    diag.*
    restart.*